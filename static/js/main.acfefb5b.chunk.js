(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{154:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),o=n(82),i=n.n(o),c=(n(95),n(18)),l=n(19),s=n(23),u=n(20),m=n(22),d=(n(96),n(165)),h=n(155),p=n(156),E=n(34),v=n(21),g=n(24),f={USER_LOGGEDIN:"USER_LOGGEDIN",USER_LOGOUT:"USER_LOGOUT",FETCH_MOVIES:"FETCH_MOVIES",FETCH_MOVIE:"FETCH_MOVIE",SET_MOVIE:"SET_MOVIE"},b=n(36),O=n.n(b);function j(e){var t=O()();return function(n){return fetch("".concat(t.REACT_APP_API_URL,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){var a;localStorage.setItem("username",e.username),localStorage.setItem("token",t.token),n((a=e.username,{type:f.USER_LOGGEDIN,username:a}))}).catch(function(e){return console.log(e)})}}function y(){return function(e){localStorage.removeItem("username"),localStorage.removeItem("token"),e({type:f.USER_LOGOUT})}}var k=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"logout",value:function(){this.props.dispatch(y())}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(d.a.Header,null,r.a.createElement(d.a.Brand,null,"My Movie DataBase MMDB")),r.a.createElement(h.a,null,r.a.createElement(E.LinkContainer,{to:"/movielist"},r.a.createElement(p.a,{eventKey:1,disabled:!this.props.loggedIn},"Movie List ")),r.a.createElement(E.LinkContainer,{to:"/movie/"+(this.props.selectedMovie?this.props.selectedMovie._id:"")},r.a.createElement(p.a,{eventKey:2,disabled:!this.props.loggedIn},"Movie Detail")),r.a.createElement(E.LinkContainer,{to:"/signin"},r.a.createElement(p.a,{eventKey:3},this.props.loggedIn?r.a.createElement("button",{onClick:this.logout.bind(this)},"Logout"):"Login")))),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",{className:"App-title"},this.props.selectedMovie?this.props.selectedMovie.title:"")))}}]),t}(a.Component),w=Object(g.k)(Object(v.b)(function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username,selectedMovie:e.movie.selectedMovie}})(k)),C=n(14);function I(e){return function(t){t(function(e){return{type:f.SET_MOVIE,selectedMovie:e}}(e))}}function S(){var e=O()();return function(t){return fetch("".concat(e.REACT_APP_API_URL,"/movies?reviews=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var n;t((n=e.movies,{type:f.FETCH_MOVIES,movies:n}))}).catch(function(e){return console.log(e)})}}function _(e){var t=O()();return function(n){return fetch("".concat(t.REACT_APP_API_URL,"/movies/").concat(e,"?reviews=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var t;n((t=e,{type:f.FETCH_MOVIE,selectedMovie:t}))}).catch(function(e){return console.log(e)})}}var M=n(157),T=n(167),L=n(43),R=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){(0,n.props.dispatch)(I(e))},n.handleSelect=n.handleSelect.bind(Object(C.a)(Object(C.a)(n))),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(S())}},{key:"handleSelect",value:function(e,t){(0,this.props.dispatch)(I(this.props.movies[e]))}},{key:"render",value:function(){var e=this;return r.a.createElement(function(t){var n=t.movieList;return n?r.a.createElement(T.a,{onSelect:e.handleSelect},n.map(function(t){return r.a.createElement(T.a.Item,{key:t._id},r.a.createElement("div",null,r.a.createElement(E.LinkContainer,{to:"/movie/"+t._id,onClick:function(){return e.handleClick(t)}},r.a.createElement(M.a,{className:"image",src:t.imageUrl,thumbnail:!0}))),r.a.createElement(T.a.Caption,null,r.a.createElement("h3",null,t.title),r.a.createElement(L.a,{glyph:"star"})," ",t.average_rating," \xa0\xa0 ",t.year))})):r.a.createElement("div",null,"Loading...")},{movieList:this.props.movies})}}]),t}(a.Component),A=Object(v.b)(function(e){return{movies:e.movie.movies}})(R),D=n(164),U=n(158),P=n(65),G=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;null==this.props.selectedMovie&&e(_(this.props._id))}},{key:"render",value:function(){var e=function(e){return e.actors.map(function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("b",null,e.actor)," ",e.character)})},t=function(e){return e.reviews.map(function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("b",null,e.reviewer)," ",e.review,r.a.createElement(L.a,{glyph:"star"})," ",e.rating)})};return r.a.createElement(function(n){var a=n.currentMovie;return a?r.a.createElement(D.a,null,r.a.createElement(D.a.Heading,null,"Movie Detail"),r.a.createElement(D.a.Body,null,r.a.createElement(M.a,{className:"image",src:a.imageUrl,thumbnail:!0})),r.a.createElement(U.a,null,r.a.createElement(P.a,null,a.title),r.a.createElement(P.a,null,r.a.createElement(e,{actors:a.cast})),r.a.createElement(P.a,null,r.a.createElement("h4",null,r.a.createElement(L.a,{glyph:"star"})," ",a.average_rating," "))),r.a.createElement(D.a.Body,null,r.a.createElement(t,{reviews:a.reviews}))):r.a.createElement("div",null,"Loading...")},{currentMovie:this.props.selectedMovie})}}]),t}(a.Component),N=Object(g.k)(Object(v.b)(function(e,t){return console.log(t),{selectedMovie:e.movie.selectedMovie,_id:t.match.params._id}})(G)),H=n(159),V=n(160),x=n(161),F=n(162),B=n(166),W=n(163),z=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).updateDetails=n.updateDetails.bind(Object(C.a)(Object(C.a)(n))),n.login=n.login.bind(Object(C.a)(Object(C.a)(n))),n.state={details:{username:"",password:""}},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"login",value:function(){(0,this.props.dispatch)(j(this.state.details))}},{key:"render",value:function(){return r.a.createElement(H.a,{horizontal:!0},r.a.createElement(V.a,{controlId:"username"},r.a.createElement(x.a,{componentClass:F.a,sm:2},"Email"),r.a.createElement(x.a,{sm:10},r.a.createElement(B.a,{onChange:this.updateDetails,value:this.state.details.username,type:"text",placeholder:"Username"}))),r.a.createElement(V.a,{controlId:"password"},r.a.createElement(x.a,{componentClass:F.a,sm:2},"Password"),r.a.createElement(x.a,{sm:10},r.a.createElement(B.a,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"}))),r.a.createElement(V.a,null,r.a.createElement(x.a,{smOffset:2,sm:10},r.a.createElement(W.a,{onClick:this.login},"Sign in"))))}}]),t}(a.Component),J=Object(v.b)(function(e){return{}})(z),K=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).updateDetails=e.updateDetails.bind(Object(C.a)(Object(C.a)(e))),e.register=e.register.bind(Object(C.a)(Object(C.a)(e))),e.state={details:{name:"",username:"",password:""}},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"register",value:function(){(0,this.props.dispatch)(function(e){var t=O()();return function(n){return fetch("".concat(t.REACT_APP_API_URL,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){n(j(e))}).catch(function(e){return console.log(e)})}}(this.state.details))}},{key:"render",value:function(){return r.a.createElement(H.a,{horizontal:!0},r.a.createElement(V.a,{controlId:"name"},r.a.createElement(x.a,{componentClass:F.a,sm:2},"Email"),r.a.createElement(x.a,{sm:10},r.a.createElement(B.a,{onChange:this.updateDetails,value:this.state.details.name,type:"text",placeholder:"Name"}))),r.a.createElement(V.a,{controlId:"username"},r.a.createElement(x.a,{componentClass:F.a,sm:2},"Email"),r.a.createElement(x.a,{sm:10},r.a.createElement(B.a,{onChange:this.updateDetails,value:this.state.details.username,type:"text",placeholder:"Username"}))),r.a.createElement(V.a,{controlId:"password"},r.a.createElement(x.a,{componentClass:F.a,sm:2},"Password"),r.a.createElement(x.a,{sm:10},r.a.createElement(B.a,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"}))),r.a.createElement(V.a,null,r.a.createElement(x.a,{smOffset:2,sm:10},r.a.createElement(W.a,{onClick:this.register},"Register"))))}}]),t}(a.Component),Q=Object(v.b)(function(e){return{}})(K),$=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={toggleReg:!1},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"showLogin",value:function(){this.setState({toggleReg:!1})}},{key:"showReg",value:function(){this.setState({toggleReg:!0})}},{key:"logout",value:function(){this.props.dispatch(y())}},{key:"render",value:function(){var e=r.a.createElement("div",null,r.a.createElement("button",{onClick:this.showLogin.bind(this)},"Login"),r.a.createElement("button",{onClick:this.showReg.bind(this)},"Register"),this.state.toggleReg?r.a.createElement(Q,null):r.a.createElement(J,null)),t=r.a.createElement("div",null,"Logged in as: ",this.props.username," ",r.a.createElement("button",{onClick:this.logout.bind(this)},"Logout"));return r.a.createElement("div",null,this.props.loggedIn?t:e)}}]),t}(a.Component),q=Object(v.b)(function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username}})($),X=n(49),Y=n(54),Z=n(89),ee={loggedIn:!!localStorage.getItem("token"),username:localStorage.getItem("username")?localStorage.getItem("username"):""},te={movies:[],selectedMovie:null},ne=[Z.a],ae=Object(Y.c)(Object(Y.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case f.USER_LOGGEDIN:return n.loggedIn=!0,n.username=t.username,n;case f.USER_LOGOUT:return n.loggedIn=!1,n.username="",n;default:return e}},movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case f.FETCH_MOVIES:return n.movies=t.movies,n.selectedMovie=t.movies[0],n;case f.SET_MOVIE:case f.FETCH_MOVIE:return n.selectedMovie=t.selectedMovie,n;default:return e}}}),Y.a.apply(void 0,ne)),re=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v.a,{store:ae},r.a.createElement(X.a,null,r.a.createElement("div",null,r.a.createElement(w,null),r.a.createElement(g.d,{exact:!0,path:"/",render:function(){return r.a.createElement(A,null)}}),r.a.createElement(g.d,{path:"/movielist",render:function(){return r.a.createElement(A,null)}}),r.a.createElement(g.d,{path:"/movie/:movieId",render:function(){return r.a.createElement(N,null)}}),r.a.createElement(g.d,{path:"/signin",render:function(){return r.a.createElement(q,null)}})))))}}]),t}(a.Component),oe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ie(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(re,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/CSC3916_HW5",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/CSC3916_HW5","/service-worker.js");oe?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ie(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ie(e)})}}()},90:function(e,t,n){e.exports=n(154)},95:function(e,t,n){},96:function(e,t,n){}},[[90,1,2]]]);
//# sourceMappingURL=main.acfefb5b.chunk.js.map